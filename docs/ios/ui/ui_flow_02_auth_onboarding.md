# UI Flow 02 - 認證與引導流程

## 1. 啟動畫面 (Splash Screen)

### 視覺元素
- App Logo (監督圖標) - 120x120 pt，螢幕中央
- App Name "Kantoku" - SF Pro Display, 32pt, Bold，深藍色
- 載入動畫 - 淡入 + 細微脈衝效果

### 互動行為
- 無使用者互動
- 顯示時間：最少 1.5 秒，最多 3 秒（根據 API 響應時間）
- 檢查登入狀態：已登入 → Dashboard，未登入 → 登入畫面

---

## 2. 登入畫面 (Login Screen)

### 版面配置
- Logo 區塊（上方，Logo 80x80 pt + App Name + Slogan）
- 表單區塊（中間）
- 按鈕區塊（下方）
- 整體使用 VStack，左右 padding 24pt

### 表單元素

**Email 輸入框：**
- Label: "電子郵件"
- Placeholder: "your@email.com"
- 左側圖標：信封
- 驗證：Email 格式，錯誤時紅色外框
- 高度 48pt，圓角 8pt

**Password 輸入框：**
- Label: "密碼"
- SecureField，可切換顯示/隱藏
- 左側圖標：鎖頭，右側：眼睛圖標
- 驗證：最少 8 字元，建議包含大小寫字母和數字
- 即時顯示密碼強度：弱（紅）/中（橘）/強（綠）
- 高度 48pt，圓角 8pt

**忘記密碼連結：**
- 文字："忘記密碼？"
- 位置：密碼框下方右對齊
- 顏色：主色調藍色
- 字體：14pt
- 點擊進入忘記密碼流程（見本文件後方）

**登入按鈕：**
- Primary Button 樣式
- 文字："登入"
- 寬度 100%，高度 50pt，圓角 12pt
- 背景：主色調藍色，文字：白色
- Loading 狀態：顯示 Spinner

**Apple Sign In 按鈕：**
- Apple 官方樣式（SignInWithAppleButton）
- 文字："使用 Apple 登入"
- 寬度 100%，高度 50pt，圓角 12pt
- 黑色背景（Light Mode）/ 白色背景（Dark Mode）
- 放置於登入按鈕與註冊按鈕之間
- 分隔線："或" - Caption，次要色，置中

**註冊按鈕：**
- Secondary Button 樣式
- 文字："還沒有帳號？立即註冊"
- 透明背景 + 藍色外框

### 互動流程
1. 使用者輸入 Email 與密碼
2. 即時表單驗證（欄位填寫、格式檢查）
3. 點擊「登入」→ 顯示 Loading
4. 呼叫 Supabase Auth API
5. 成功：儲存 Session → Dashboard
6. 失敗：顯示錯誤訊息（Toast 或輸入框下方紅色文字）

### 錯誤處理
- "請輸入有效的電子郵件地址"
- "密碼長度至少 8 個字元"
- "電子郵件或密碼錯誤"
- "網路連線異常，請稍後再試"
- 顯示方式：Toast（頂部）或輸入框下方 + 震動反饋

---

## 3. 註冊畫面 (Sign Up Screen)

### 版面配置
- 使用 ScrollView 包裹 VStack
- 標題區（上方）
- 表單區（中間）
- 按鈕區（下方）
- 左右 padding 24pt

### 表單元素

**標題區：**
- 主標題："開始你的日文學習旅程" - 24pt, Bold
- 副標題："只需一分鐘，即可開始學習" - 14pt, 次要文字色

**顯示名稱輸入框：**
- Label: "顯示名稱"
- Placeholder: "例: 小明"
- MaxLength: 20 字元
- 圖標：人物
- 驗證：必填，2-20 字元

**Email 輸入框：**
- 同登入畫面
- 額外驗證：檢查 Email 是否已註冊

**密碼輸入框：**
- 同登入畫面
- 新增密碼強度指示器（弱/中/強，紅/橘/綠）

**確認密碼輸入框：**
- Label: "確認密碼"
- SecureField
- 圖標：鎖頭
- 驗證：必須與密碼相符，即時顯示勾選/錯誤圖標

**每日目標設定：**
- Label: "每日學習目標"
- Segmented Control: 15/30/45/60 分鐘
- 預設：30 分鐘
- 說明文字："建議新手從 15-30 分鐘開始" - 12pt，次要色

**建立帳號按鈕：**
- Primary Button
- 文字："建立帳號"
- 完整寬度

**登入連結：**
- 文字："已有帳號？登入"
- 顏色：藍色

### 互動流程
1. 使用者填寫所有欄位
2. 即時驗證各欄位（輸入時）
3. 點擊「建立帳號」→ 完整表單驗證
4. 顯示 Loading
5. 呼叫 Supabase Auth API 創建帳號
6. 創建 Profile 記錄
7. 成功：自動登入 → Onboarding
8. 失敗：顯示錯誤訊息

### 驗證規則
- 顯示名稱：必填，2-20 字元
- Email：必填，有效格式，不可重複
- 密碼：必填，至少 8 字元（建議：大小寫+數字+特殊字元）
- 確認密碼：必填，與密碼相符

---

## 4. 引導流程 (Onboarding)

### 整體架構
- TabView (PageTabViewStyle) - 4 頁滑動式介紹
- 頂部右上角："跳過" 按鈕
- 底部：頁面指示器 + "下一步"/"開始" 按鈕

### Page 1: 歡迎來到 Kantoku

**內容：**
- 插圖：onboarding_welcome (高度 300pt)
- 標題："歡迎來到 Kantoku" - 28pt, Bold
- 說明："你的專屬日文學習監督者\n陪你從零開始，扎實學習日文 50 音" - Body，次要色，置中對齊

### Page 2: 漸進式學習系統

**內容：**
- 插圖：學習路徑（50音 → 單字 → 測驗 → 進階）
- 標題："漸進式學習系統"
- 說明：
  * "學會幾個假名，立刻學習相關單字"
  * "循序漸進，穩固基礎"
  * "每個階段都有測驗確保掌握"
- 重點標記：
  * ✓ 從基礎開始
  * ✓ 邊學邊用
  * ✓ 定期測驗

### Page 3: 你的專屬監督者

**內容：**
- 插圖：AI 監督者形象（專業但友善）
- 標題："嚴格但友善的 AI 監督者"
- 功能說明：
  * 📝 每日任務生成 - "根據你的進度，每天自動生成合適的學習任務"
  * 🔍 AI 審核反饋 - "即時審核你的作業，提供詳細的改進建議"
  * 🔥 學習追蹤 - "Streak 機制鼓勵每日學習，養成良好習慣"
  * 📊 弱項分析 - "智能分析你的弱點，生成針對性複習任務"

### Page 4: 開始學習吧

**內容：**
- 成功圖示：大型勾選圓圈（80pt，綠色）
- 標題："準備好了嗎？" - 28pt, Bold
- 說明："讓我們開始你的日文學習之旅！\n每天只需 15-30 分鐘，持續進步"
- 大型開始按鈕：Primary Button，最大寬度 280pt

### 互動設計

**頁面切換：**
- 左右滑動切換頁面
- 頁面指示器顯示當前位置（1/4, 2/4...）
- "下一步" 按鈕點擊前進
- 最後一頁顯示 "開始學習" 按鈕

**跳過功能：**
- 右上角 "跳過" 按鈕
- 點擊顯示確認對話框："確定要跳過引導嗎？"
- 確認後直接進入 Dashboard

**動畫效果：**
- 頁面切換：淡入淡出 + 橫向滑動
- 插圖：輕微的視差效果
- 文字：依序淡入動畫

### 完成流程
1. 使用者完成所有頁面或點擊跳過
2. 標記 Onboarding 完成狀態
3. 轉場至 Dashboard
4. 顯示歡迎 Toast: "歡迎！讓我們開始第一個任務"

---

## 設計注意事項

### 表單 UX
- 使用者輸入時即時驗證
- 清晰的錯誤訊息
- 成功狀態視覺回饋（綠色勾選）
- Tab 鍵切換欄位（支援鍵盤導航）

### 無障礙
- 所有輸入框標記 Accessibility Label
- 錯誤訊息支援 VoiceOver
- 充足的觸控目標大小（最小 44x44 pt）
- 色盲友善的錯誤提示（不只靠顏色）

### 效能
- 輸入驗證使用防抖動（Debounce）避免頻繁檢查
- 圖片預先載入
- 平滑的轉場動畫（避免卡頓）

---

## 5. 忘記密碼流程 (Forgot Password Flow)

### 畫面 1: 輸入 Email
- 標題：「重設密碼」
- 說明：「輸入你的 Email，我們會發送重設連結」
- Email 輸入框：自動填入登入頁的輸入（若有）
- 「發送重設連結」按鈕：Primary Button

### 畫面 2: 發送成功
- 成功圖示（綠色勾選，80pt）
- 標題：「郵件已發送」
- 說明：「請查看你的信箱 xxx@email.com\n點擊連結以重設密碼」
- 「返回登入」按鈕：Primary Button
- 「沒收到？重新發送」連結：Tertiary Button（60 秒冷卻倒數）

### 畫面 3: 重設密碼（從 Email 連結進入）
- 標題：「設定新密碼」
- 新密碼輸入框（帶強度指示器）
- 確認密碼輸入框
- 「確認」按鈕：Primary Button

### 畫面 4: 重設成功
- 成功圖示
- 標題：「密碼已更新」
- 「返回登入」按鈕

### 錯誤處理
- Email 不存在：顯示通用訊息「如果此 Email 存在，我們已發送重設連結」（安全考量）
- 連結過期：「連結已過期，請重新申請」
- 密碼不符合要求：即時驗證提示
